<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interview Scheduler</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      background: white;
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .header h1 {
      color: #667eea;
      margin-bottom: 10px;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .tab {
      padding: 12px 24px;
      border: none;
      background: #f0f0f0;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }

    .tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .tab:hover {
      transform: translateY(-2px);
    }

    .content-section {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: none;
    }

    .content-section.active {
      display: block;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      font-weight: 600;
      color: #666;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
      transform: translateY(-2px);
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .btn-success:hover {
      background: #218838;
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background: #c82333;
    }

    .interviews-grid {
      display: grid;
      gap: 20px;
    }

    .interview-card {
      background: #f9f9f9;
      border-radius: 12px;
      padding: 20px;
      border-left: 5px solid #667eea;
      transition: all 0.3s;
    }

    .interview-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .interview-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }

    .interview-title {
      font-size: 18px;
      font-weight: 700;
      color: #333;
      margin-bottom: 5px;
    }

    .interview-position {
      color: #667eea;
      font-weight: 600;
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .status-scheduled {
      background: #d1ecf1;
      color: #0c5460;
    }

    .status-completed {
      background: #d4edda;
      color: #155724;
    }

    .status-canceled {
      background: #f8d7da;
      color: #721c24;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
    }

    .interview-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 15px 0;
    }

    .detail-item {
      display: flex;
      align-items: start;
      gap: 8px;
    }

    .detail-icon {
      color: #667eea;
      font-size: 18px;
    }

    .detail-content {
      flex: 1;
    }

    .detail-label {
      font-size: 12px;
      color: #999;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .detail-value {
      color: #333;
      font-weight: 500;
    }

    .interview-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #e0e0e0;
      flex-wrap: wrap;
    }

    .action-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.3s;
    }

    .filter-section {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filter-section select,
    .filter-section input {
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
    }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }

      .interview-details {
        grid-template-columns: 1fr;
      }

      .tabs {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìÖ Interview Manager</h1>
      <p style="color: #666; margin-top: 10px;">Schedule, manage, and track all your interviews in one place</p>
      
      <div class="tabs">
        <button class="tab active" onclick="showTab('schedule')">Schedule New Interview</button>
        <button class="tab" onclick="showTab('upcoming')">Upcoming Interviews</button>
        <button class="tab" onclick="showTab('completed')">Completed Interviews</button>
        <button class="tab" onclick="showTab('all')">All Interviews</button>
      </div>
    </div>

    <!-- Schedule Interview Section -->
    <div id="schedule" class="content-section active">
      <h2 style="margin-bottom: 20px; color: #333;">üìù Schedule New Interview</h2>
      
      <div id="scheduleAlert" class="alert"></div>

      <form id="scheduleForm">
        <div class="form-grid">
          <div class="form-group">
            <label for="candidateSelect">Candidate *</label>
            <select id="candidateSelect" required>
              <option value="">Select Candidate</option>
            </select>
          </div>

          <div class="form-group">
            <label for="positionSelect">Position *</label>
            <select id="positionSelect" required>
              <option value="">Select Position</option>
              <option value="Software Engineer">Software Engineer</option>
              <option value="Senior Software Engineer">Senior Software Engineer</option>
              <option value="Data Analyst">Data Analyst</option>
              <option value="Data Scientist">Data Scientist</option>
              <option value="Product Manager">Product Manager</option>
              <option value="Project Manager">Project Manager</option>
              <option value="Business Analyst">Business Analyst</option>
              <option value="DevOps Engineer">DevOps Engineer</option>
              <option value="QA Engineer">QA Engineer</option>
              <option value="UI/UX Designer">UI/UX Designer</option>
              <option value="HR Manager">HR Manager</option>
              <option value="Sales Executive">Sales Executive</option>
              <option value="Marketing Manager">Marketing Manager</option>
              <option value="Accountant">Accountant</option>
              <option value="Operations Manager">Operations Manager</option>
            </select>
          </div>

          <div class="form-group">
            <label for="roundSelect">Interview Round *</label>
            <select id="roundSelect" required>
              <option value="">Select Round</option>
              <option value="Phone Screening">Phone Screening</option>
              <option value="Technical Round 1">Technical Round 1</option>
              <option value="Technical Round 2">Technical Round 2</option>
              <option value="Managerial Round">Managerial Round</option>
              <option value="HR Round">HR Round</option>
              <option value="Final Round">Final Round</option>
            </select>
          </div>

          <div class="form-group">
            <label for="interviewDate">Date & Time *</label>
            <input type="datetime-local" id="interviewDate" required>
          </div>

          <div class="form-group">
            <label for="interviewer1Select">Primary Interviewer *</label>
            <select id="interviewer1Select" required>
              <option value="">Select Interviewer</option>
              <option value="Interviewer 1">Interviewer 1</option>
              <option value="Interviewer 2">Interviewer 2</option>
              <option value="Interviewer 3">Interviewer 3</option>
              <option value="Interviewer 4">Interviewer 4</option>
              <option value="Interviewer 5">Interviewer 5</option>
              <option value="Technical Lead">Technical Lead</option>
              <option value="HR Manager">HR Manager</option>
              <option value="Department Head">Department Head</option>
              <option value="CTO">CTO</option>
              <option value="CEO">CEO</option>
            </select>
          </div>

          <div class="form-group">
            <label for="interviewer2Select">Second Interviewer (Optional)</label>
            <select id="interviewer2Select">
              <option value="">Select Interviewer</option>
              <option value="Interviewer 1">Interviewer 1</option>
              <option value="Interviewer 2">Interviewer 2</option>
              <option value="Interviewer 3">Interviewer 3</option>
              <option value="Interviewer 4">Interviewer 4</option>
              <option value="Interviewer 5">Interviewer 5</option>
              <option value="Technical Lead">Technical Lead</option>
              <option value="HR Manager">HR Manager</option>
              <option value="Department Head">Department Head</option>
              <option value="CTO">CTO</option>
              <option value="CEO">CEO</option>
            </select>
          </div>

          <div class="form-group">
            <label for="interviewer3Select">Third Interviewer (Optional)</label>
            <select id="interviewer3Select">
              <option value="">Select Interviewer</option>
              <option value="Interviewer 1">Interviewer 1</option>
              <option value="Interviewer 2">Interviewer 2</option>
              <option value="Interviewer 3">Interviewer 3</option>
              <option value="Interviewer 4">Interviewer 4</option>
              <option value="Interviewer 5">Interviewer 5</option>
              <option value="Technical Lead">Technical Lead</option>
              <option value="HR Manager">HR Manager</option>
              <option value="Department Head">Department Head</option>
              <option value="CTO">CTO</option>
              <option value="CEO">CEO</option>
            </select>
          </div>

          <div class="form-group">
            <label for="interviewLink">Interview Link (Optional)</label>
            <input type="url" id="interviewLink" placeholder="https://meet.google.com/...">
          </div>

          <div class="form-group full-width">
            <label for="interviewLocation">Location (Optional)</label>
            <input type="text" id="interviewLocation" placeholder="e.g., Conference Room A, Building 2">
          </div>

          <div class="form-group full-width">
            <label for="interviewNotes">Notes (Optional)</label>
            <textarea id="interviewNotes" rows="4" placeholder="Add any additional notes about the interview..."></textarea>
          </div>
        </div>

        <button type="submit" class="btn btn-primary">üìÖ Schedule Interview</button>
      </form>
    </div>

    <!-- Upcoming Interviews Section -->
    <div id="upcoming" class="content-section">
      <h2 style="margin-bottom: 20px; color: #333;">üìÜ Upcoming Interviews</h2>
      <div class="filter-section">
        <input type="date" id="upcomingDateFilter" placeholder="Filter by date">
        <select id="upcomingPositionFilter">
          <option value="">All Positions</option>
        </select>
      </div>
      <div id="upcomingInterviewsList" class="interviews-grid">
        <div class="loading">Loading upcoming interviews...</div>
      </div>
    </div>

    <!-- Completed Interviews Section -->
    <div id="completed" class="content-section">
      <h2 style="margin-bottom: 20px; color: #333;">‚úÖ Completed Interviews</h2>
      <div class="filter-section">
        <input type="text" id="completedSearchInput" placeholder="Search by candidate name...">
        <select id="completedPositionFilter">
          <option value="">All Positions</option>
        </select>
      </div>
      <div id="completedInterviewsList" class="interviews-grid">
        <div class="loading">Loading completed interviews...</div>
      </div>
    </div>

    <!-- All Interviews Section -->
    <div id="all" class="content-section">
      <h2 style="margin-bottom: 20px; color: #333;">üìã All Interviews</h2>
      <div class="filter-section">
        <input type="text" id="allSearchInput" placeholder="Search by candidate name...">
        <select id="allStatusFilter">
          <option value="">All Status</option>
          <option value="scheduled">Scheduled</option>
          <option value="completed">Completed</option>
          <option value="canceled">Canceled</option>
          <option value="pending">Pending</option>
        </select>
        <select id="allPositionFilter">
          <option value="">All Positions</option>
        </select>
      </div>
      <div id="allInterviewsList" class="interviews-grid">
        <div class="loading">Loading all interviews...</div>
      </div>
    </div>
  </div>

  <script>
    const API_URL = 'http://localhost:3000';
    let allInterviews = [];
    let candidates = [];

    function getToken() {
      return localStorage.getItem('companyToken');
    }

    function showTab(tabName) {
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
      });
      
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });

      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');

      if (tabName !== 'schedule') {
        loadInterviews();
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await loadCandidates();
      await loadInterviews();
    });

    async function loadCandidates() {
      const token = getToken();
      if (!token) {
        showAlert('Please log in first', 'error');
        return;
      }

      try {
        const response = await fetch(`${API_URL}/api/candidates`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        candidates = await response.json();
        
        const select = document.getElementById('candidateSelect');
        select.innerHTML = '<option value="">Select Candidate</option>' + 
          candidates.map(c => `<option value="${c.id}">${c.name}</option>`).join('');

      } catch (error) {
        console.error('Error loading candidates:', error);
        showAlert('Error loading candidates', 'error');
      }
    }

    document.getElementById('scheduleForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const token = getToken();
      if (!token) {
        showAlert('Please log in first', 'error');
        return;
      }

      const candidateId = document.getElementById('candidateSelect').value;
      const candidate = candidates.find(c => c.id == candidateId);

      const formData = {
        candidate_id: candidateId,
        candidate_name: candidate ? candidate.name : '',
        position: document.getElementById('positionSelect').value,
        round: document.getElementById('roundSelect').value,
        interview_date: document.getElementById('interviewDate').value,
        interviewer_1: document.getElementById('interviewer1Select').value,
        interviewer_2: document.getElementById('interviewer2Select').value || null,
        interviewer_3: document.getElementById('interviewer3Select').value || null,
        interview_link: document.getElementById('interviewLink').value || null,
        interview_location: document.getElementById('interviewLocation').value || null,
        notes: document.getElementById('interviewNotes').value || null,
        status: 'scheduled'
      };

      try {
        const response = await fetch(`${API_URL}/api/interviews`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });

        if (!response.ok) throw new Error('Failed to schedule interview');

        showAlert('‚úÖ Interview scheduled successfully!', 'success');
        document.getElementById('scheduleForm').reset();
        await loadInterviews();

      } catch (error) {
        console.error('Error scheduling interview:', error);
        showAlert('‚ùå Failed to schedule interview. Please try again.', 'error');
      }
    });

    async function loadInterviews() {
      const token = getToken();
      if (!token) return;

      try {
        const response = await fetch(`${API_URL}/api/interviews`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });

        if (!response.ok) throw new Error('Failed to load interviews');

        allInterviews = await response.json();
        console.log('Loaded interviews:', allInterviews);

        displayUpcomingInterviews();
        displayCompletedInterviews();
        displayAllInterviews();
        populatePositionFilters();

      } catch (error) {
        console.error('Error loading interviews:', error);
        showEmptyState('upcomingInterviewsList', 'Error loading interviews');
        showEmptyState('completedInterviewsList', 'Error loading interviews');
        showEmptyState('allInterviewsList', 'Error loading interviews');
      }
    }

    function populatePositionFilters() {
      const positions = [...new Set(allInterviews.map(i => i.position))];
      const filterIds = ['upcomingPositionFilter', 'completedPositionFilter', 'allPositionFilter'];
      
      filterIds.forEach(filterId => {
        const select = document.getElementById(filterId);
        select.innerHTML = '<option value="">All Positions</option>' + 
          positions.map(p => `<option value="${p}">${p}</option>`).join('');
      });
    }

    function displayUpcomingInterviews() {
      const now = new Date();
      const upcoming = allInterviews.filter(interview => {
        const interviewDate = new Date(interview.interview_date);
        return interviewDate > now && interview.status === 'scheduled';
      });

      const container = document.getElementById('upcomingInterviewsList');
      
      if (upcoming.length === 0) {
        showEmptyState('upcomingInterviewsList', 'üìÖ No upcoming interviews scheduled');
        return;
      }

      container.innerHTML = upcoming.map(interview => createInterviewCard(interview)).join('');
    }

    function displayCompletedInterviews() {
      const completed = allInterviews.filter(i => i.status === 'completed');
      
      const container = document.getElementById('completedInterviewsList');
      
      if (completed.length === 0) {
        showEmptyState('completedInterviewsList', '‚úÖ No completed interviews yet');
        return;
      }

      container.innerHTML = completed.map(interview => createInterviewCard(interview)).join('');
    }

    function displayAllInterviews() {
      const container = document.getElementById('allInterviewsList');
      
      if (allInterviews.length === 0) {
        showEmptyState('allInterviewsList', 'üìã No interviews found');
        return;
      }

      container.innerHTML = allInterviews.map(interview => createInterviewCard(interview)).join('');
    }

    function createInterviewCard(interview) {
      const interviewDate = new Date(interview.interview_date);
      const formattedDate = interviewDate.toLocaleDateString('en-US', { 
        weekday: 'short', 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric' 
      });
      const formattedTime = interviewDate.toLocaleTimeString('en-US', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });

      const interviewers = [
        interview.interviewer_1,
        interview.interviewer_2,
        interview.interviewer_3
      ].filter(Boolean).join(', ');

      return `
        <div class="interview-card">
          <div class="interview-header">
            <div>
              <div class="interview-title">${interview.candidate_name}</div>
              <div class="interview-position">${interview.position}</div>
            </div>
            <span class="status-badge status-${interview.status}">${interview.status}</span>
          </div>

          <div class="interview-details">
            <div class="detail-item">
              <span class="detail-icon">üìÖ</span>
              <div class="detail-content">
                <div class="detail-label">Date</div>
                <div class="detail-value">${formattedDate}</div>
              </div>
            </div>

            <div class="detail-item">
              <span class="detail-icon">üïê</span>
              <div class="detail-content">
                <div class="detail-label">Time</div>
                <div class="detail-value">${formattedTime}</div>
              </div>
            </div>

            <div class="detail-item">
              <span class="detail-icon">üéØ</span>
              <div class="detail-content">
                <div class="detail-label">Round</div>
                <div class="detail-value">${interview.round}</div>
              </div>
            </div>

            <div class="detail-item">
              <span class="detail-icon">üë•</span>
              <div class="detail-content">
                <div class="detail-label">Interviewers</div>
                <div class="detail-value">${interviewers}</div>
              </div>
            </div>

            ${interview.interview_link ? `
              <div class="detail-item">
                <span class="detail-icon">üîó</span>
                <div class="detail-content">
                  <div class="detail-label">Link</div>
                  <div class="detail-value">
                    <a href="${interview.interview_link}" target="_blank" style="color: #667eea;">Join Meeting</a>
                  </div>
                </div>
              </div>
            ` : ''}

            ${interview.interview_location ? `
              <div class="detail-item">
                <span class="detail-icon">üìç</span>
                <div class="detail-content">
                  <div class="detail-label">Location</div>
                  <div class="detail-value">${interview.interview_location}</div>
                </div>
              </div>
            ` : ''}
          </div>

          ${interview.notes ? `
            <div style="margin-top: 15px; padding: 12px; background: white; border-radius: 8px; border-left: 3px solid #667eea;">
              <div class="detail-label">Notes</div>
              <div class="detail-value">${interview.notes}</div>
            </div>
          ` : ''}

          <div class="interview-actions">
            ${interview.status === 'scheduled' ? `
              <button class="action-btn btn-success" onclick="updateStatus(${interview.id}, 'completed')">
                ‚úÖ Mark Completed
              </button>
              <button class="action-btn btn-danger" onclick="updateStatus(${interview.id}, 'canceled')">
                ‚ùå Cancel
              </button>
            ` : ''}
            ${interview.status === 'canceled' ? `
              <button class="action-btn btn-primary" onclick="updateStatus(${interview.id}, 'scheduled')">
                üîÑ Reschedule
              </button>
            ` : ''}
            <button class="action-btn" style="background: #667eea; color: white;" onclick="viewInterviewDetails(${interview.id})">
              üëÅÔ∏è View Details
            </button>
          </div>
        </div>
      `;
    }

    async function updateStatus(interviewId, newStatus) {
      const confirmMessage = newStatus === 'completed' 
        ? 'Mark this interview as completed?' 
        : newStatus === 'canceled'
        ? 'Cancel this interview?'
        : 'Reschedule this interview?';

      if (!confirm(confirmMessage)) return;

      const token = getToken();
      try {
        const response = await fetch(`${API_URL}/api/interviews/${interviewId}/status`, {
          method: 'PATCH',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ status: newStatus })
        });

        if (!response.ok) throw new Error('Failed to update status');

        showAlert(`‚úÖ Interview status updated to ${newStatus}`, 'success');
        await loadInterviews();

      } catch (error) {
        console.error('Error updating status:', error);
        alert('‚ùå Failed to update interview status');
      }
    }

    function viewInterviewDetails(interviewId) {
      const interview = allInterviews.find(i => i.id === interviewId);
      if (!interview) return;

      const interviewers = [
        interview.interviewer_1,
        interview.interviewer_2,
        interview.interviewer_3
      ].filter(Boolean).join(', ');

      alert(`Interview Details:\n\n` +
        `Candidate: ${interview.candidate_name}\n` +
        `Position: ${interview.position}\n` +
        `Round: ${interview.round}\n` +
        `Date: ${new Date(interview.interview_date).toLocaleString()}\n` +
        `Interviewers: ${interviewers}\n` +
        `Status: ${interview.status}\n` +
        `${interview.interview_link ? `\nLink: ${interview.interview_link}` : ''}` +
        `${interview.interview_location ? `\nLocation: ${interview.interview_location}` : ''}` +
        `${interview.notes ? `\nNotes: ${interview.notes}` : ''}`
      );
    }

    function showAlert(message, type) {
      const alertDiv = document.getElementById('scheduleAlert');
      alertDiv.className = `alert alert-${type}`;
      alertDiv.textContent = message;
      alertDiv.style.display = 'block';

      setTimeout(() => {
        alertDiv.style.display = 'none';
      }, 5000);
    }

    function showEmptyState(containerId, message) {
      const container = document.getElementById(containerId);
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">üì≠</div>
          <p>${message}</p>
        </div>
      `;
    }

    // Filter functions
    document.getElementById('upcomingDateFilter')?.addEventListener('change', filterUpcoming);
    document.getElementById('upcomingPositionFilter')?.addEventListener('change', filterUpcoming);
    document.getElementById('completedSearchInput')?.addEventListener('input', filterCompleted);
    document.getElementById('completedPositionFilter')?.addEventListener('change', filterCompleted);
    document.getElementById('allSearchInput')?.addEventListener('input', filterAll);
    document.getElementById('allStatusFilter')?.addEventListener('change', filterAll);
    document.getElementById('allPositionFilter')?.addEventListener('change', filterAll);

    function filterUpcoming() {
      const dateFilter = document.getElementById('upcomingDateFilter').value;
      const positionFilter = document.getElementById('upcomingPositionFilter').value;
      
      const now = new Date();
      let filtered = allInterviews.filter(interview => {
        const interviewDate = new Date(interview.interview_date);
        return interviewDate > now && interview.status === 'scheduled';
      });

      if (dateFilter) {
        filtered = filtered.filter(i => {
          const iDate = new Date(i.interview_date).toISOString().split('T')[0];
          return iDate === dateFilter;
        });
      }

      if (positionFilter) {
        filtered = filtered.filter(i => i.position === positionFilter);
      }

      const container = document.getElementById('upcomingInterviewsList');
      if (filtered.length === 0) {
        showEmptyState('upcomingInterviewsList', 'üìÖ No interviews match the filters');
      } else {
        container.innerHTML = filtered.map(interview => createInterviewCard(interview)).join('');
      }
    }

    function filterCompleted() {
      const searchTerm = document.getElementById('completedSearchInput').value.toLowerCase();
      const positionFilter = document.getElementById('completedPositionFilter').value;
      
      let filtered = allInterviews.filter(i => i.status === 'completed');

      if (searchTerm) {
        filtered = filtered.filter(i => 
          i.candidate_name.toLowerCase().includes(searchTerm)
        );
      }

      if (positionFilter) {
        filtered = filtered.filter(i => i.position === positionFilter);
      }

      const container = document.getElementById('completedInterviewsList');
      if (filtered.length === 0) {
        showEmptyState('completedInterviewsList', '‚úÖ No interviews match the filters');
      } else {
        container.innerHTML = filtered.map(interview => createInterviewCard(interview)).join('');
      }
    }

    function filterAll() {
      const searchTerm = document.getElementById('allSearchInput').value.toLowerCase();
      const statusFilter = document.getElementById('allStatusFilter').value;
      const positionFilter = document.getElementById('allPositionFilter').value;
      
      let filtered = [...allInterviews];

      if (searchTerm) {
        filtered = filtered.filter(i => 
          i.candidate_name.toLowerCase().includes(searchTerm)
        );
      }

      if (statusFilter) {
        filtered = filtered.filter(i => i.status === statusFilter);
      }

      if (positionFilter) {
        filtered = filtered.filter(i => i.position === positionFilter);
      }

      const container = document.getElementById('allInterviewsList');
      if (filtered.length === 0) {
        showEmptyState('allInterviewsList', 'üìã No interviews match the filters');
      } else {
        container.innerHTML = filtered.map(interview => createInterviewCard(interview)).join('');
      }
    }
  </script>
</body>
</html>